<!DOCTYPE html>
<html lang="ar" dir="rtl" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>دواجن ERP Enterprise</title>
    
    <!-- PWA Config -->
    <meta name="theme-color" content="#0f766e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/3050/3050128.png" type="image/png">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { primary: '#0f766e', secondary: '#3b82f6', danger: '#ef4444', darkbg: '#0f172a', darkcard: '#1e293b' },
                    fontFamily: { sans: ['Tajawal', 'sans-serif'] }
                }
            }
        }
    </script>

    <!-- Assets -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <!-- 0. SPLASH SCREEN -->
    <div id="splashScreen" class="fixed inset-0 z-50 bg-white flex flex-col items-center justify-center text-primary">
        <div class="animate-bounce mb-6">
            <div class="w-24 h-24 bg-gradient-to-br from-emerald-400 to-emerald-600 rounded-full flex items-center justify-center shadow-2xl shadow-emerald-500/40">
                <i class="fa-solid fa-feather-pointed text-5xl text-white"></i>
            </div>
        </div>
        <h1 class="text-4xl font-black tracking-tight mb-2">دواجن ERP</h1>
        <p class="text-slate-400 font-bold tracking-widest uppercase text-sm">Enterprise Edition</p>
    </div>

    <!-- 1. LOGIN SCREEN -->
    <div id="loginScreen" class="hidden flex flex-col items-center justify-center h-full p-6 bg-slate-100 dark:bg-darkbg">
        <div class="bg-white dark:bg-darkcard p-8 rounded-3xl shadow-xl w-full max-w-sm text-center relative overflow-hidden">
            <!-- Decorative Circle -->
            <div class="absolute -top-10 left-1/2 transform -translate-x-1/2 w-20 h-20 bg-emerald-500 rounded-full flex items-center justify-center border-8 border-slate-100 dark:border-darkbg shadow-lg z-10">
                <i class="fa-solid fa-fingerprint text-3xl text-white"></i>
            </div>
            
            <div class="mt-10 mb-6">
                <h2 class="text-2xl font-bold dark:text-white">تسجيل دخول المدير</h2>
                <p class="text-slate-500 text-sm">أدخل رمز الحماية للمتابعة</p>
            </div>
            
            <div class="flex gap-3 justify-center mb-8" dir="ltr">
                <input type="password" id="pinInput" maxlength="4" class="w-16 h-20 text-center text-3xl font-black border-2 border-slate-200 rounded-2xl focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/20 outline-none dark:bg-slate-800 dark:border-slate-700 dark:text-white transition-all" placeholder="•">
            </div>
            <button onclick="App.login()" class="w-full bg-primary hover:bg-emerald-600 text-white py-4 rounded-2xl font-bold shadow-lg shadow-emerald-500/30 transition transform active:scale-95">دخول للنظام</button>
            <p class="mt-6 text-xs text-slate-400 font-mono">Default PIN: 1234</p>
        </div>
    </div>

    <!-- APP CONTAINER -->
    <div id="appContainer" class="hidden flex-1 flex flex-col overflow-hidden">
        
        <!-- Header -->
        <header class="bg-white dark:bg-darkcard shadow-sm px-4 py-3 flex justify-between items-center z-20 transition-colors duration-300">
            <div class="flex items-center gap-3">
                <div class="bg-emerald-100 dark:bg-emerald-900/30 text-primary p-2 rounded-lg"><i class="fa-solid fa-layer-group"></i></div>
                <h1 id="headerTitle" class="text-xl font-black text-slate-800 dark:text-white">لوحة المدير</h1>
            </div>
            <div class="flex gap-3">
                <button onclick="App.router('notifications')" class="relative w-10 h-10 rounded-xl bg-slate-100 dark:bg-slate-700 flex items-center justify-center text-slate-600 dark:text-slate-300 transition">
                    <i class="fa-solid fa-bell"></i>
                    <span id="notifBadge" class="hidden absolute top-0 right-0 w-3 h-3 bg-red-500 rounded-full border-2 border-white dark:border-darkcard"></span>
                </button>
                <button onclick="App.router('settings')" class="w-10 h-10 rounded-xl bg-slate-100 dark:bg-slate-700 flex items-center justify-center text-slate-600 dark:text-slate-300 transition"><i class="fa-solid fa-gear"></i></button>
            </div>
        </header>

        <!-- Main Content -->
        <main id="mainContent" class="flex-1 overflow-y-auto p-4 scroll-smooth bg-slate-50 dark:bg-darkbg"></main>

        <!-- Bottom Navigation -->
        <nav id="mainNav" class="nav-bar bg-white dark:bg-darkcard fixed bottom-0 w-full h-20 flex justify-around items-center z-30 pb-safe px-2">
            <button onclick="App.router('dashboard')" class="nav-item flex flex-col items-center justify-center w-full h-full text-slate-400 hover:text-emerald-500 transition" data-target="dashboard"><i class="fa-solid fa-chart-pie text-xl mb-1"></i><span class="text-[10px] font-bold">الرئيسية</span></button>
            <button onclick="App.router('inventory')" class="nav-item flex flex-col items-center justify-center w-full h-full text-slate-400 hover:text-emerald-500 transition" data-target="inventory"><i class="fa-solid fa-boxes-stacked text-xl mb-1"></i><span class="text-[10px] font-bold">المخزون</span></button>
            <button onclick="App.router('flocks')" class="nav-item flex flex-col items-center justify-center w-full h-full text-slate-400 hover:text-emerald-500 transition" data-target="flocks"><i class="fa-solid fa-dove text-xl mb-1"></i><span class="text-[10px] font-bold">الدورات</span></button>
            <button onclick="App.router('reports')" class="nav-item flex flex-col items-center justify-center w-full h-full text-slate-400 hover:text-emerald-500 transition" data-target="reports"><i class="fa-solid fa-file-invoice text-xl mb-1"></i><span class="text-[10px] font-bold">التقارير</span></button>
        </nav>

        <!-- Floating Action Button -->
        <div class="fixed bottom-24 left-4 z-40 flex flex-col gap-3">
            <button onclick="App.router('addFlock')" class="w-14 h-14 bg-primary text-white rounded-full shadow-xl shadow-emerald-500/40 flex items-center justify-center text-2xl transform transition hover:scale-110 active:scale-90"><i class="fa-solid fa-plus"></i></button>
        </div>

        <button id="backBtn" onclick="App.goBack()" class="fixed top-4 left-4 z-40 w-10 h-10 bg-white dark:bg-darkcard rounded-full shadow-md flex items-center justify-center text-slate-600 dark:text-slate-300 hidden transition hover:bg-slate-100 dark:hover:bg-slate-700"><i class="fa-solid fa-arrow-right"></i></button>
    </div>

    <!-- Scripts Order is Critical -->
    <script src="database.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').then(reg => console.log('SW Registered')).catch(err => console.log('SW Fail', err));
        }
    </script>
    <script src="app.js"></script>
</body>
</html>
